<div class="language-resume-container">

  <div class="language-selector-container">
    <button class="language-selector" (click)="toggleLanguageSelector()">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        class="lucide lucide-globe w-4 h-4">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path>
        <path d="M2 12h20"></path>
      </svg>
      <span class="language-text">{{ currentLanguage.code.toUpperCase() }}</span>
      <svg class="dropdown-arrow" [ngClass]="{ 'rotate-180': isOpenSelector() }" width="12" height="8" viewBox="0 0 12 8"
        fill="none">
        <path d="M1 1.5L6 6.5L11 1.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
    </button>

    @if(isOpenSelector()) {
    <!-- Enhanced Backdrop with blur -->
    @if(isOpenSelector()) {
      <div class="overlay-layer" (click)="toggleLanguageSelector()"></div>
    }

    <!-- Apple-style Dropdown - Responsive sizing  -->
    <div
      class="absolute top-full right-0 mt-3 w-56 lg:w-64 xl:w-72 2xl:w-80 z-[70] animate-in slide-in-from-top-2 duration-200">
      <!-- Main dropdown container with glassmorphism -->
      <div class="relative backdrop-blur-3xl bg-[#0f0227]/80 border border-white/20 rounded-3xl shadow-2xl overflow-hidden">
        <!-- Additional blur layer -->
        <div class="absolute inset-0 backdrop-blur-2xl bg-gradient-to-br from-white/15 via-purple-500/10 to-blue-500/10"></div>

        <!-- Animated liquid blobs - Responsive sizing -->
        <div class="absolute -top-10 -right-10 w-16 h-16 lg:w-20 lg:h-20 xl:w-24 xl:h-24 bg-gradient-to-br from-purple-400/30 to-blue-400/30 rounded-full blur-xl animate-pulse"></div>
        <div class="absolute -bottom-10 -left-10 w-12 h-12 lg:w-16 lg:h-16 xl:w-20 xl:h-20 bg-gradient-to-tr from-pink-400/30 to-purple-400/30 rounded-full blur-xl animate-pulse delay-1000"></div>

        <!-- Content -->
        <div class="relative p-2 lg:p-3 xl:p-4">
          @for (language of supportedLanguages; track language.code) {
          <button (click)="handleLanguageChange(language)"
            class="relative w-full px-4 py-3 lg:px-5 lg:py-4 xl:px-6 xl:py-5 2xl:px-7 2xl:py-6 text-left text-sm lg:text-base xl:text-lg 2xl:text-xl transition-all duration-300 flex items-center gap-3 lg:gap-4 xl:gap-5 group rounded-2xl btn-menu-option cursor-pointer"
            [ngClass]="{ 'text-white bg-white/15 backdrop-blur-md shadow-lg scale-[0.98]': isSelectedLang(language), 'text-white/80 hover:text-white hover:bg-white/8 hover:backdrop-blur-md hover:scale-[0.99]': !isSelectedLang(language) }"
            [disabled]="isLoadingLanguage()">

            <!-- Selection indicator -->
            @if(currentLanguage.code === language.code) {
            <div
              class="absolute inset-0 bg-gradient-to-r from-purple-500/20 via-blue-500/20 to-purple-500/20 rounded-2xl animate-pulse">
            </div>
            }

            <!-- Content -->
            <div class="relative flex items-center gap-3 lg:gap-4 xl:gap-5 w-full">
              <span
                class="text-xl lg:text-2xl xl:text-3xl 2xl:text-4xl group-hover:scale-110 transition-transform duration-300 filter drop-shadow-sm">
                {{ language.flag }}
              </span>
              <span class="font-medium tracking-wide">{{language.name}}</span>

              @if(currentLanguage.code === language.code) {
              <div class="ml-auto flex items-center">
                <div
                  class="w-2 h-2 lg:w-3 lg:h-3 xl:w-4 xl:h-4 bg-gradient-to-r from-purple-400 to-blue-400 rounded-full animate-pulse shadow-lg">
                </div>
              </div>
              }

              <!-- Loading indicator for current selection -->
              @if(isLoadingLanguage() && currentLanguage.code === language.code) {
              <div class="ml-auto flex items-center">
                <svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </div>
              }
            </div>

            <!-- Hover liquid effect -->
            <div
              class="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-500 rounded-2xl">
            </div>
          </button>
          }
        </div>

        <!-- Bottom accent line -->
        <div
          class="absolute bottom-0 left-4 right-4 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent">
        </div>
      </div>

      <!-- Floating shadow -->
      <div class="absolute inset-0 -z-10 bg-black/20 blur-2xl rounded-3xl transform translate-y-2 scale-95"></div>
    </div>
    }
  </div>


  <div class="divider"></div>

  <header-resume-button></header-resume-button>
</div>
